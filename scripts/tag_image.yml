---

- name: Get New Tag
  shell: "git describe --tags --abbrev=0 | awk -F. -v OFS=. 'NF==1{print ++$NF}; NF>1{if(length($NF+1)>length($NF))$(NF-1)++; $NF=sprintf("%0*d", length($NF), ($NF+1)%(10^length($NF))); print}')"
  register: out.NEW_TAG

- name: New Tag Value
  shell: echo "Next release tag is $NEW_TAG"
  register: out

# - name: "Tag images"
#   shell: "docker rmi chonku/jffs-ui:LATEST"
#   register: out
#   ignore_errors: true
